!function(n,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):n.router5ListenersPlugin=e()}(this,function(){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},e="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(e){return void 0===e?"undefined":n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":n(e)};function t(n){return n.split(".").reduce(function(n,e){return n.concat(n.length?n[n.length-1]+"."+e:e)},[])}function o(n){return n&&n.meta&&n.meta.params}function r(n,e){return o(e)&&(void 0!==(t=e.meta.params[n])&&null!==t)?Object.keys(e.meta.params[n]).reduce(function(n,t){return n[t]=e.params[t],n},{}):{};var t}var u={autoCleanUp:!0};return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u;function i(u){var i={};function c(n,e){return e?i[n]&&(i[n]=i[n].filter(function(n){return n!==e})):i[n]=[],u}function f(n,e,t){var o=n.replace(/^(\*|\^|=)/,"");return o&&!/^\$/.test(n)&&(u.rootNode.getSegmentsByName(o)||console.warn("No route found for "+o+", listener might never be called!")),i[n]||(i[n]=[]),i[n]=(t?[]:i[n]).concat(e),u}function a(n,e,t){(i[n]||[]).forEach(function(o){-1!==i[n].indexOf(o)&&o(e,t)})}return u.getListeners=function(){return i},u.addListener=function(n){return f("*",n)},u.removeListener=function(n){return c("*",n)},u.addNodeListener=function(n,e){return f("^"+n,e,!0)},u.removeNodeListener=function(n,e){return c("^"+n,e)},u.addRouteListener=function(n,e){return f("="+n,e)},u.removeRouteListener=function(n,e){return c("="+n,e)},{onTransitionSuccess:function(u,i,f){var s=function(n,u){var i=u?t(u.name):[],c=t(n.name),f=Math.min(i.length,c.length),a=void 0;a=u&&(o(u)||o(n))?function(){var t=void 0,o=function(){var e=i[t],o=c[t];if(e!==o)return{v:t};var f=r(e,n),a=r(o,u);return f.length!==a.length?{v:t}:0===f.length?"continue":Object.keys(f).some(function(n){return a[n]!==f[n]})?{v:t}:void 0};for(t=0;t<f;t+=1){var a=o();switch(a){case"continue":continue;default:if("object"===(void 0===a?"undefined":e(a)))return a.v}}return t}():0;var s=i.slice(a).reverse(),l=c.slice(a);return{intersection:u&&a>0?i[a-1]:"",toDeactivate:s,toActivate:l}}(u,i),l=s.intersection,d=s.toDeactivate,m=f.reload?"":l,v=u.name;n.autoCleanUp&&d.forEach(function(n){return c("^"+n)}),a("^"+m,u,i),a("="+v,u,i),a("*",u,i)}}}return i.pluginName="LISTENERS_PLUGIN",i}});
